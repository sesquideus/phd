Until now, de-biasing of meteor data for estimating the flux and the mass index was done using empirical and analytical methods directly to the data.
In this work, the authors build a simulator which enables them to understand the influence of individual biases with the hope of reproducing observational data sets using their simulations.

All changes in the text are marked with **.


Main text:

Line 17 - Note that "Ayers, W. G. (1965). Luminous efficiency of an artificial meteor at 11.9 kilometers per second." did this a long time ago. They created artificial iron meteors, albeit at a low (~11 km/s) velocity.
    !!!

Line 27 - "density of the atmosphere" - Note that the atmosphere mass density is also model dependent, as direct measurements of not usually available.
    accepted, made clearer by adding "or modelled"

Line 37 - Change *meteor sightings* to "a local coordinate system".
    reformulated

Line 40 paragraph - Also mention which optical systems will be used, I assume AMOS? Could you give some brief details about this system?

Line 53 - "simulation of dark flight" - the dark flight occurs once the ablation has stopped, so one would naturally not use an ablation model.
    True, however in the used model dm/dt tends to zero very quickly at speeds below 6 km/s. And of course, it can be set to zero manually, or employ a better model that takes meteoroid temperature into account.

Line 55 - "Effects of meteoroid fragmentation... are not taken into account" - Note that meteor fragmentation seems to be an essential part of the meteor phenomenon.
This is known for a long time (Verniani, F. (1969). Structure and fragmentation of meteoroids. Space Science Reviews, 10(2), 230-261.), and has recently been shown to be quite prevalent
in most meteors using direct observations (Subasinghe et al. (2016). Physical characteristics of faint meteors by light curve and high-resolution observations, and the implications for parent bodies.
Monthly Notices of the Royal Astronomical Society, 457(2), 1289-1298.). Discussion about how this influences your results is needed.

Line 60 - "collection" - Or perhaps just a mean value of each, as the frame integration sums up all of these, and we just observe the mean?
    Currently we only extract the instantaneous data at exact timestamps of frames. This is definitely a valuable improvement and will be implemented in further versions.

Line 66 - "for most purposes" - Well, for the purpose of trajectory estimation or any serious attempts in reconstructing a trajectory would be quite significant. Is using the WGS84 model really that much slower?
    Since we were only concerned with statistical processing of thousands of meteors and the relative error is only on the order of f^2, or several tens of metres for 100 km altitude and 500 km.
    For individual meteors it is a substantial improvement, but for large datasets it does not make much of a change.
    In the meantime we found (Osen (2019) Accurate ECEF conversion) and I wrote a Python-C++ binding which is about fast as working with spherical Earth in pure Python.
    So since 12/2019 there is an option to work with WGS84. I am not sure if it is appropriate to rewrite it in the paper though.

Line 76 - "... are much more difficult to describe analytically" - and are negligible in any case for fainter meteors.
    Of course, we just stated this explicitly.

Line 80 - Change *a non-differential* to "analytical".
    accepted

Line 82 - Add to the beginning of the paragraph "Due to the modular nature of our code, ..." and reword the rest to fit.
    accepted

Line 94 - "The only problematic quantity here is the drag coefficient" - I would beg to differ. The true atmosphere density might also be problematic, as it is model-dependent and can vary significantly with varying solar activity.
See Picone et al. (2002) NRLMSISE‐00 empirical model of the atmosphere: Statistical comparisons and scientific issues.
    Accepted. By "problematic" we mean it is not possible to determine its value at all, without knowing the shape of the body first. True atmospheric density is model-dependent, but at least
    theoretically can be measured. I added a brief explanation.

Line 98 - "value of 0.5" - For Reynolds numbers of ~10^4, gamma should be ~1, as used by everyone else in the field. Are you perhaps confusing gamma with Cd? Cd for a spherical particle is 0.47, which is roughly 0.5.
    Accepted. The convention of using gamma = 2 C_d is confusing, I took special care to fix it when I found out, but I missed this one.
    We tried a better model that computes Re and Gamma directly, but it is heavily dependent on the precise shape and fails for very low densities.

Equation 6 - I suggest dropping equation (5) and only keeping eq (6), as they are essentially the same.
    accepted

Line 114 - For what meteoroid type is which value of Q? You might refer to Ceplecha et al. (1998) for details.
    This was taken for cometary material. However the value is not important, it is in the configuration file and can be changed depending on the purpose of the particular simulation run.

Equation 7 - Drop the equation after the second "=", because m' is already known.
- Just below it, "to determine the value of \tau", add "luminous efficiency" before \tau, because it is not defined what it is.
    This is just an explicit substitution. Accepted.

Line 124 - "the spectral sensitivity of the observer is similar to human eyes" - Is this a fact? Can you provide a reference? CCD sensors may be more sensitive in the IR, although the intensifiers might not.
    Not truly a fact, just a simple assumption. Ideally the camera should be calibrated and the conversion from absolute to apparent magnitudes should take this into account.
    Currently we do not have such data, so it was not included in the paper.

Line 129 - Note that "Weryk, R. J., & Brown, P. G. (2013). Simultaneous radar and video meteors—II: Photometry and ionisation. Planetary and Space Science, 81, 32-47."
    derived values for CCD sensors which may be more applicable for your purposes.
    Noted.

Line 138 - Comment for the whole section - In reality, the air mass density can vary up to +/- 50% (see the Picone reference above). Could you comment how would that influence your model?
    The most important influence here would be the increase in initial height. The importance of this depends heavily on the use of the simulation.
    In determination of meteoroid fluxes it barely increases the collection are and can be corrected for. For tracking a single body it cannot be corrected easily.
    In any case, the model can be substituted very simply by exporting the MSIS database for any particular time or position.

Line 159 and equation 9 - If this is computed for meteors in the atmosphere, the geocentric velocity is not what you should use. It differs from the in-atmosphere velocity quite a bit, see the
classical Ceplecha (1987) for details.
    The "geocentric velocity" here refers to the instantaneous velocity in the ECEF frame (in which the camera is stationary), not the pre-atmospheric velocity of the meteoroid.
    I believe as such it is mathematically correct.

Line 181 - "Material density \rho" - What density is used exactly? It determines most critical parameters of a meteor such as the begin height, peak height, peak magnitude, etc.
    This depends on the application. As this paper is technical and aims to present the methods only, we cannot state this.
    In our research --as yet incomplete -- for Perseids we used constant 620 kg/m^3. A more complex population generator could sample practically any distribution, including multimodal ones.
    This must be determined from observations for any particular purpose.

Line 184 - The first two paragraphs in this section are quite confusing, and the terms population and mass index are used interchangeably, which is not correct.
I recommend that the first two paragraphs are replaced by the following: "Meteoroid mass distribution is assumed to follow a power law m^-s, where s is the mass index.
Since any heavy-tailed distribution derived from measurements tapers off at small sizes (m -> 0) due to observational effects, another constraint for minimum mass m_{min} must be applied."
Also, omit the last sentence in the second paragraph.
    Accepted, I cannot understand how the swapped population/mass index may have gone unnoticed. However I disagree with the statement it is caused by observational effects.
    In the simulation we simply assume m^-s without bounds, which truly diverges. The limit should be set low enough so as not to reduce the numbers of observable meteors.

Line 194 to 206 - The issues with the expected value and the variance are not pertinent to this discussion and I am unsure why they are discussed at all.
The goal here is to compare the model distribution to the observed distribution, which should not be hampered by these theoretical concerns.
I understand that from the perspective of generating a mass for the simulation it is necessary to put an upper boundary, but this can be easily informed from observations,
as you are not interested in meteorite dropping fireballs here.
    Accepted, this can be removed.

Line 196 - Replace "for meteoroid populations with" with "for mass indices of".
    accepted

Line 232 - "Inverse of the distance from the Earth's centre" - The volume changes with ~r^3, not ~r, if you want the uniform volume density.
But note that the initial height also depends on physical properties (rho, Q) so it cannot just be randomly generated.
    I suppose this is a misunderstanding. This is not the initial height of the **meteor**, or "the beginning of the visible trail", but the $r$-coordinate of the initial position of the **meteoroid**.
    If we set this to at least 150 km, meteoroids emit very little visible light in the first few frames since the density of the atmosphere is low. In theory the simulation
    could begin at 500 km or so, but then even more frames would have very high absolute magnitudes and thus would not be interesting.
    The initial height of the **meteor** is automatically determined by the simulation, for instance as the first frame where the absolute magnitude is at most +6.
    The ~1/r dependence is obviously wrong, but so is 1/r^3... we actually need 1/r^2 as the **rate of change** of the volume with increasing r. My bad.

Line 238 - "it is necessary to take the effect of changing altitude of the radiant into account" - Could you provide a reference for the method used to correct this?
    We believed a sufficient explanation was in the two following sentences.

Line 257 - "For statistical evaluation of meteor showers one integration step per video frame is sufficient." - So you mean that you are using the time step of 1/FPS in the integrator,
or that you are just sampling the integrator results at the FPS frequency?
    Here we set the time step to 1/FPS. We can compare the results directly by increasing the resolution with the same initial configuration, the difference
    tends to zero with increased resolution as expected. The bound can be set experimentally for any initial configuration, here it came out that one RK4 integration step is sufficient.
    In the meantime we have implemented an adaptive Dormand-Prince integrator that varies $n$ (not FPS) as needed, but this is not mentioned in this version of the paper.

Line 264 - "it intersects the Earth's surface" - for non-meteorite dropping fireballs, stopping at the height of 30 km is sufficient.
    "ascends above 400 km" - would it perhaps be wise to cull all simulated meteors with the entry angle < 15 deg before this step, so the program is not generating grazers?
    It is sufficient, but for typical values of s practically all meteoroids are small enough to ablate completely.
    Culling the grazers completely does not seem like a good idea (for instance rising Geminids produce a lot of grazers).
    Maybe < 0 deg would be sufficient. Then again, these meteoroids only waste computational time but do not skew the results.

Equation 12 - Define theta here. Could alpha be estimated from a flat field? Can you give a reference for this expression?
    Accepted. Currently this is purely empirical, we emphasised it in the text.

Line 317, the whole section - This effect may be simulated by generating synthetic meteor imagery and feeding them into the AMOS pipeline.
That may also be the only way to capture other algorithmic biases (i.e. meteor detector biases) which are not discussed here at all.
    Very true. It would be very valuable, but it is a very complex task, currently far beyond the scope of this paper.

Lines 334 - 336 - Which of these approaches has proven to be the best in practice? I would image that the KS test would be best if you are comparing two different distributions.
    This was a tradeoff between ease of implementation and precision. For determination of fluxes the difference was not much, we chose the chi^2 test because it
    was much easier to implement at the time. After brief experimentation with KS tests we decided it did not offer significant improvement even though mathematically it is more rigorous.
    Currently I am trying to devise a KDE method for comparing spherical positional data along with mass and velocity, but it is not so simple.

Line 351 - You also might want to consider Particle Swarm Optimization.
    Thank you, this is exactly what we needed.

Figure 1 - What coordinate system is this figure in? I presume alt/az? State explicitly.
    accepted

Line 379 - Move the whole Applications section to Introduction and change it so that it serves as a brief overview and a motivation for this work, as that is currently lacking.
    Accepted, we realize that in a technical paper this is the most problematic section.

Line 398 - It might be worth mentioning these biases when they are introduced, directly in the text above, so the readers are aware of potential pitfalls when reading the paper.

Line 405 - "Variations in the drag coefficient..." - Is this important for these meteors which ablate in the free molecular flow regime, and not continuous flow?
    This is indeed very important but difficult to implement, apart from a full CFD simulation (which is of course very expensive in terms of computation time).
    Currently we are trying to find a better model. Unfortunately, the transition regime between FMF and CF is very difficult to summarize in a simple formula which
    could be used in a simulation like this. For small meteoroids that ablated quickly this was not so critical.


- END OF DOCUMENT -

\Epigraph[0.4]{
    It is not what you think of \\
    when I say I'm doing modelling.
}{
}




\section{Models of meteoroid dynamics} \label{mm}





\section{Models of the Earth}
    Apart from the model of meteoroid dynamics, an important consideration is the level of precision
    of the model of the Earth. We distinguish three separate models:

    \begin{itemize}
        \item A \emph{locally flat} Earth, which describes the close vicinity of the observer,
            generally in Cartesian coordinates. It is useful for describing strictly local events
            in the coordinate system of the observer, such as the simulation of the dark flight phase of a meteor.
        \item A \emph{spherical} Earth, which is a suitable approximation for global coverage,
            where high precision of trajectories and observation is not a concern, such as determination
            of particle flux or density maps.
        \item An \emph{oblate spheroid} model of the Earth, which provides higher
            precision but is computationally more expensive.
    \end{itemize}

    Further refinement is possible by implementing a geoid model. This is usually done by means of
    a spherical harmonics expansion \cite{???}, which accounts for variations in local gravity
    and deviations of the local vertical.
    In meteor science, this level of precision is generally not needed as any improvement over the
    oblate spheroid model will be dominated by other sources of measurement errors.
    More precise models thus will not be investigated in this thesis.


    \subsection{Locally flat Earth} \label{mmf}
     directly in the coordinates of the observer

     \emph{local tangent plane coordinates}

     The coordinate system of choice

    with three Cartesian coordinates:
     \begin{description}
         \item[northing]
         \item[easting]
         \item[altitude]
     \end{description}



    \subsection{Spherical Earth} \label{mms}
        The natural next step is to consider a spherical Earth model.
        The true shape of the Earth's zero-altitude surface differs from
        a perfect sphere by no more than one part in 300, which introduces errors
        that are for many purposes negligible.

        In mathematics, it is custom to denote spherical coordinates by the triplet
        $(r, \theta, \phi)$, where
        \begin{itemize}
            \item $r \in \IntervalCO{0}{\infty}$ is the \emph{radial distance} from the origin of the coordinate system;
            \item $\theta \in \IntervalCC{0}{\pi}$ is the \emph{polar angle} or \emph{inclination}, measured
                from a chosen reference direction called the \textit{zenith},
                $\theta$;
            \item $\phi \in \IntervalCO{0}{2\pi}$ is the \emph{azimuthal angle}, the angle between the projection
                of $\vec{r}$ into the plane perpendicular to the zenith direction, and
                a chosen reference direction with that plane, called the \textit{azimuth reference direction}.
        \end{itemize}

        (picture)

        However, for describing location in the ECEF frame it is more convenient
        to use the \emph{geographical convention} with coordinates $(\phi, \lambda, h)$, and degrees
        instead of radians for angular measures. The coordinates are then -- somewhat
        confusingly -- rewritten as
        \begin{itemize}
            \item \emph{latitude} $\phi \in \IntervalCC{\ang{-90}}{\ang{+90}}$,
                measured from the equator, with values increasing towards the North Pole;
            \item \emph{longitude} $\lambda \in \IntervalCC{\ang{-180}}{\ang{+180}}$,
                measured from the IERS Reference Meridian, with values increasing towards east;
            \item \emph{altitude} $h \in \IntervalCC{-R_\Earth}{\infty}$,
                measured from the surface of a sphere with diameter equal to the radius
                of the model of the Earth $R_\Earth$, increasing outwards.
                At this level of approximation the value of $R_0$ can be chosen somewhat arbitrarily.
                The equatorial radius of \SI{6378137}{\metre} or mean radius of \SI{6371008}{\metre} are commonly used.
                For the sake of clarity and consistency we use the value of \SI{6371008}{\metre} in our models.
                Negative values represent points below the surface of the Earth --
                while theoretically possible, they are of no interest in meteor
                astronomy\footnote{unless we're observing near the Dead Sea
                or a meteorite is found inside a mine shaft}.
        \end{itemize}

        (picture)

        Tre transformation functions are then
        \aln{eq:mms-xyz-to-sph}{
            h       &= \sqrt{x^2 + y^2 + z^2} - R_\Earth, \\
            \phi    &= \arccos{\frac{z}{x^2 + y^2 + z^2}}, \\
            \lambda &= \mathrm{atan2}(y, x).
        }
        and the inverse transformation is given as
        \aln{eq:mss-sph-to-xyz}{
            x &= \left(h + R_\Earth\right) \cos\phi \cos\lambda, \\
            y &= \left(h + R_\Earth\right) \cos\phi \sin\lambda. \\
            z &= \left(h + R_\Earth\right) \sin\phi.
        }

        While absolute errors are on the order of kilometres, typical scales of interest
        in meteor science are not spanning the entire diameter of the Earth,
        but only hundreds of kilometres, which keeps relative errors considerably lower.

        For a camera observing a meteor at a typical altitude of \SI{100}{\kilo\metre},
        the 

        (conduct experiment here)


    \subsection{Oblate spheroid} \label{mmw}
        An even better approximation is to use an oblate spheroid,
        that is, an ellipsoid with a shorter polar axis and two
        equal longer equatorial axes.

        The standard model to be used is \emph{WGS84}.
        The difference from the geoid is at most -105/+85 metres,
        which translates to a negligible local error.

        The coordinates used are the same as in the spherical model. (Altitude always perpendicular to equipotential surface)

        The transformation formulae are mathematically complex and beyond the scope of this thesis.
        In our models we use the implementation by \cite{osen2017},
        for further information including a description of the code, refer to this report.

    \subsection{Conclusion}
        With currently available computational power it is no longer reasonable to
        use a locally-flat Earth model, not even for the simplest cases.
        The transformations involved in the use of the spherical model
        are simple and computationally inexpensive enough to warrant its employment everywhere.

        We recommend to use the WGS84 model for most applications, with a possible
        fallback to the spherical Earth model where computational speed is crucial.
